---
title: "[BIGDATA] 1-3 스크립트 언어에 의한 특별 분석과 데이터 프레임"

categories: 
  - BIGDATA
tags:
  - [bigdata, 공부]

toc: true
toc_sticky: true
---

# 빅데이터의 기초 지식


## 스크립트 언어에 의한 특별 분석과 데이터 프레임

'데이터'는 다양한 장소에 존재하고 있으며, 그것을 수집하는 과정에서 스크립트 언어가 자주 사용된다.


### 데이터 처리와 스크립트 언어 - 인기 언어인 파이썬과 데이터 프레임

데이터 분석을 하려면 우선 데이터를 수집해야 한다. <br> 파일 서버에서 다운로드하는 경우도 있지만, 인터넷 경우의 API로부터 얻을 수도 있다. <br> 그리고 원시 데이터 그대로는 BI 도구로 읽을 수 없어 '전처리(preprocessing)'가 필요한 데이터도 있다.


이때 많이 사용하는 것이 스크립트 언어다. <br> 스크립트 언어 중 인기 있는 것은 'R'(R 언어)과 '파이썬' 두 가지다. <br> 데이터 엔지니어 사이에서는 파이썬의 인기가 높은데 그 배경에는 다음과 같은 이유가 있다.

- 통계 분석에 특화된 R과 비교했을 때, 파이썬은 범용의 스크립트 언어로 발전한 역사가 있고, 다양한 분야의 라이브러리를 손에 넣을 수 있다. <br> 특히, 외부 시스템의 API를 호출하거나, 복잡한 문자열 처리가 필요한 데이터 전처리에 적합하다.

- 파이썬은 과할 기술 계산 분야에서 오랜 기간 사용되었고 Numpy와 SciPy라는 수치 계산용 라이브러리와 머신러닝의 프레임워크가 충실하다. <br> 데이터 처리 분야에서는 R에서 사용하는 '데이터 프레임'의 모델을 파이썬으로 만든 라이브러리인 pandas를 많이 사용하고 있다.

특히 '데이터 프레임'의 프로그래밍 모델은 효과적이며, 데이터 처리의 스크립트화를 생각하는 데 있어서 빠뜨릴 수 없는 존재가 되었다.


### 데이터 프레임, 기초 중의 기초 - '배열 안의 배열'로부터 작성

'데이터 프레임(data frame)'은 표 형식의 데이터를 추상화한 객체이다.

표 형식의 데이터는 가로와 세로의 2차원 배열로 나누어져 있고, '배열 안의 배열'을 준비하면 데이터 프레임을 만들 수 있다.

데이터 프레임을 사용하면 스크립트 언어 안에서 데이터 가공과 집계를 할 수 있다.


### 웹 서버의 액세스 로그의 예 - pandas의 데이터 프레임으로 간단히 처리

예로 리스트 1.1과 같은 웹 서버의 액세스 로그를 생각해보자. <br> 이러한 데이터는 데이터 웨어하우스와 BI 도구에서 그대로 읽어 들일 수가 없다.


##### 리스트1.1 웹사이트의 액세스 로그
    x.x.x.x - - [01/Jul/1995:00:00:01 -0400] "Get /history/apollo..." 200 6245
    x.x.x.x - - [01/Jul/1995:00:00:06 -0400] "Get /shuttle/countd..." 200 3985
    * 예제 데이터 'NASA-HTTP- The internet Traffic Archive'
    https://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html

따라서, 이 데이터를 파이썬 정규식을 사용해 파싱해보도록 한다. <br> 다음과 같이 파일의 각 행의 분해하여 칼럼 명을 지정한다.

```python
import re
import pandas as pd

# 로그의 각 행에 매치하는 정규 표현
pattern = re.compile('^\S+ \S+ \S+ \[(.*)\] "(.*)" (\S+) (\S+)$') 
```




**데이터 전처리에서 사용할 수 있는 pandas의 함수**


### 시계열 데이터를 대화식으로 집계하기 - 데이터 프레임을 그대로 사용한 데이터 집계


### SQL의 결과를 데이터 프레임으로 활용하기



**실행 결과를 확인하는 부분에서는 데이터 프레임을 사용한다**