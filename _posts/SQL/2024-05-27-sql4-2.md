---
title: "[SQL] 04-2 두 테이블을 묶는 조인"

categories: 
  - SQL
tags:
  - [SQL, 데이터베이스, DBMS, 공부]

toc: true
toc_sticky: true
---

# SQL 고급 문법

## 두 테이블을 묶는 조인

조인(join)이란 두 개의 테이블을 서로 묶어서 하나의 결과를 만들어 내는 것을 말한다.



### 내부 조인

두 테이블을 연결할 때 가장 맣이 사용되는 것이 내부 조인이다. <br> 그냥 조인이라 부르면 내부 조인을 의미하는 것이다.

#### 일대다 관계의 이해

두 테이블의 조인을 위해서는 테이블이 일대다(one to many) 관계로 연결되어야 한다. <br> 먼저 일대다 관계에 대해서 알아보겠다.


데이터베이스의 테이블은 하나로 구성되는 것보다는 여러 정보를 주제에 따라 분리해서 저장하는 것이 효율적이다. <br> 이 분리된 테이블은 서로 관계(relation)를 맺고 있다. <br> 이러한 대표적인 사례가 인터넷 마켓 데이터베이스(market_db)의 회원 테이블과 구매 테이블이다.


market_db에서 회원 테이블의 아이디와 구매 테이블의 아이디는 일대다 관계이다. <br> 일대다 관계란 한쪽 테이블에는 하나의 값만 존재해야 하지만, 연결된 다른 테이블에는 여러 개의 값이 존재할 수 있는 관계를 말한다.

예를 들어, 회원 테이블에서 블랙핑크의 아이디는 'BLK'로 1명(1, one)밖에 없다. <br> 그래서 회원 테이블의 아이디를 기본키(Primary Key, PK)로 지정해따. <br> 구매 테이블의 아이디에서는 3개의 BLK를 찾을 수 있다. <br> 즉, 회원은 1명이지만 이 회원은 구매를 여러 번(다, many) 할 수 있는 것이다. <br> 그래서 구매 테이블의 아이디는 기본 키가 아닌 외래 키(Foreign Key, FK)로 설정했다.


#### 내부 조인의 기본

일반적으로 조인이라고 부르는 것은 내부 조인(inner join)을 말하는 것으로, 조인 중에서 가장 많이 사용된다.

내부 조인의 형식은 다음과 같다.

```
SELECT <열 목록>
FROM <첫 번째 테이블>
    INNER JOIN <두 번째 테이블>
    ON <조인될 조건>
[WHERE 검색 조건]
```

구매 테이블에는 물건을 구매한 회원의 아이디와 물건 등의 정보만 있다. <BR> 이 물건을 배송하기 위해서는 구매한 회원의 주소 및 연락처를 알아야 한다. <BR> 이 회원의 주소, 연락처를 알기 위해 정보가 있는 회원 테이블과 결합하는 것이 내부 조인이다.


구매 테이블에서 GRL이라는 아이디를 가진 사람이 구매한 물건을 발송하기 위해 다음과 같이 조인해서 이름/주소/연락처 등을 검색할 수 있다.


```SQL
USE market_db;
SELECT *
    FROM buy
    INNER JOIN member
    ON buy.mem_id = member.mem_id
WHERE buy.mem_id = 'GRL';
```
![스크린샷 2024-05-27 214515](https://github.com/gsh06169/gsh06169/assets/150469460/d8dfc5dd-7f3a-4d45-90ed-55dff8e4acf0)

1. 구매 테이블의 mem_id(buy.mem_id)인 'GRL'을 추출한다.
2. 'GRL'과 동일한 값을 회원 테이블의 mem_id(member.mem_id) 열에서 검색한다.
3. 'GRL'이라는 아이디를 찾으면 구매 테이블과 회원 테이블의 두 행을 결합(JOIN)한다.


WHERE 절을 생략하면 구매 테이블의 모든 행이 회원 테이블과 결합한다.


#### 내부 조인의 간결한 표현

이번에는 필요한 아이디/이름/구매 물품/주소/연락처만 추출해보겠다.


```SQL
SELECT mem_id, mem_name, prod_name, addr, CONCAT(phone1, phone2) '연락처'
    FROM buy
    INNER JOIN member
    ON buy.mem_id = member.mem_id
```



### 중복된 결과 1개만 출력하기





### 외부 조인






### 기타 조인
