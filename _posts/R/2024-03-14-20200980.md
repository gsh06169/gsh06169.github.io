# 통계프로그래밍 파이썬 HW2

제출 기한 : 2023년 11월 21일 23시 59분

아래의 문제들을 파이썬 코드를 이용해서 풀고, .ipynb 파일로 제출하시오.

## 1. 다음 데이터는 미국의 한 인터넷 쇼핑몰 데이터이다. 쇼핑몰 데이터를 이용하여 아래의 문제에 답하여라.


```python
import pandas as pd
data = pd.read_csv('shopping_trends.csv')
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer ID</th>
      <th>Age</th>
      <th>Gender</th>
      <th>Item Purchased</th>
      <th>Category</th>
      <th>Purchase Amount (USD)</th>
      <th>Location</th>
      <th>Size</th>
      <th>Color</th>
      <th>Season</th>
      <th>Review Rating</th>
      <th>Subscription Status</th>
      <th>Payment Method</th>
      <th>Shipping Type</th>
      <th>Discount Applied</th>
      <th>Promo Code Used</th>
      <th>Previous Purchases</th>
      <th>Preferred Payment Method</th>
      <th>Frequency of Purchases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>55</td>
      <td>Male</td>
      <td>Blouse</td>
      <td>Clothing</td>
      <td>53</td>
      <td>Kentucky</td>
      <td>L</td>
      <td>Gray</td>
      <td>Winter</td>
      <td>3.1</td>
      <td>Yes</td>
      <td>Credit Card</td>
      <td>Express</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>14</td>
      <td>Venmo</td>
      <td>Fortnightly</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>19</td>
      <td>Male</td>
      <td>Sweater</td>
      <td>Clothing</td>
      <td>64</td>
      <td>Maine</td>
      <td>L</td>
      <td>Maroon</td>
      <td>Winter</td>
      <td>3.1</td>
      <td>Yes</td>
      <td>Bank Transfer</td>
      <td>Express</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>2</td>
      <td>Cash</td>
      <td>Fortnightly</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>50</td>
      <td>Male</td>
      <td>Jeans</td>
      <td>Clothing</td>
      <td>73</td>
      <td>Massachusetts</td>
      <td>S</td>
      <td>Maroon</td>
      <td>Spring</td>
      <td>3.1</td>
      <td>Yes</td>
      <td>Cash</td>
      <td>Free Shipping</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>23</td>
      <td>Credit Card</td>
      <td>Weekly</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>21</td>
      <td>Male</td>
      <td>Sandals</td>
      <td>Footwear</td>
      <td>90</td>
      <td>Rhode Island</td>
      <td>M</td>
      <td>Maroon</td>
      <td>Spring</td>
      <td>3.5</td>
      <td>Yes</td>
      <td>PayPal</td>
      <td>Next Day Air</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>49</td>
      <td>PayPal</td>
      <td>Weekly</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>45</td>
      <td>Male</td>
      <td>Blouse</td>
      <td>Clothing</td>
      <td>49</td>
      <td>Oregon</td>
      <td>M</td>
      <td>Turquoise</td>
      <td>Spring</td>
      <td>2.7</td>
      <td>Yes</td>
      <td>Cash</td>
      <td>Free Shipping</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>31</td>
      <td>PayPal</td>
      <td>Annually</td>
    </tr>
  </tbody>
</table>
</div>



### (a) 나이(Age)를 x축, 평점(Review Rating 변수)을y축으로 가지는 산점도를 그리는데, 구매한 물품의 색깔(Color 변수)이 Red이면 빨간색 점, Orange이면 주황색 점, White이면 흰색 점으로 표현하고 나머지 색깔은 동일하게 표현하여라.


```python
import matplotlib.pyplot as plt

y2 = data[data['Color'] == 'Red']['Review Rating']
y3 = data[data['Color'] == 'Orange']['Review Rating']
y4 = data[data['Color'] == 'White']['Review Rating']
y1 = data[data['Color'].isin(['Red', 'Orange', 'White']) == False]['Review Rating']

plt.scatter(data[data['Color'].isin(['Red', 'Orange', 'White']) == False]['Age'], y1)
plt.scatter(data[data['Color'] == 'Red']['Age'], y2, color='red')
plt.scatter(data[data['Color'] == 'Orange']['Age'], y3, color = 'orange')
plt.scatter(data[data['Color'] == 'White']['Age'], y4, color = 'white')
plt.show()
```


    
![png](output_6_0.png)
    


### (b) 평점에 나이, 구매금액(Purchase Amount), 과거구매횟수(Previous Purchases)가 영향을 주는지 확인하기 위하여, pairplot을 그리고 heatmap을 이용해 상관계수를 표현하여라.


```python
import seaborn as sns

data1 = data[['Age', 'Purchase Amount (USD)', 'Previous Purchases', 'Review Rating']]
sns.pairplot(data1)
```




    <seaborn.axisgrid.PairGrid at 0x24aff99fc10>




    
![png](output_8_1.png)
    



```python
sns.heatmap(data1.corr(), annot = True)
```




    <Axes: >




    
![png](output_9_1.png)
    


### (c) 구매 카테고리(Category)에 따라 상품평점에 차이가 있는지 확인하고자 한다. 신발(Footwear)을 구매한 고객들의 평점이 옷(Clothing)을 구매한 고객들의 평점보다 높다는 것을 유의수준 5\%에서 검정하여라. 이 때, 신발과 옷을 구매한 사람들의 분산이 같은지 먼저 검정한 후 결과에 따라 t-test를 사용하여라. 또한 95\% 신뢰구간도 구하여라.


```python
from scipy import stats

stats.bartlett(data.loc[data.Category == 'Footwear', 'Review Rating'], data.loc[data.Category == 'Clothing', 'Review Rating'])
```




    BartlettResult(statistic=0.008123334166832915, pvalue=0.9281842743963111)



H0: 신발을 구매한 고객들의 평점의 분산과 옷을 구매한 고객들의 평점의 분산이 같다.
H1: 신발을 구매한 고객들의 평점의 분산과 옷을 구매한 고객들의 평점의 분산이 다르다.
p-value가 0.9281842743963111로 유의수준 0.05보다 크므로 귀무가설을 기각하지 못한다. 따라서 신발을 구매한 고객들의 평점의 분산과 옷을 구매한 고객들의 평점의 분산은 같다고 할 수 있다.


```python
stats.ttest_ind(data.loc[data.Category == 'Footwear', 'Review Rating'], data.loc[data.Category == 'Clothing', 'Review Rating'], equal_var = True, alternative = 'greater')
```




    Ttest_indResult(statistic=1.9836639806539123, pvalue=0.02370515108300721)



H0: 신발을 구매한 고객들의 평점과 옷을 구매한 고객들의 평점이 같다.
H1: 신발을 구매한 고객들의 평점이 옷을 구매한 고객들의 평점보다 높다.
pvalue가 0.02370515108300721로 유의수준 0.05보다 작으므로 귀무가설을 기각한다. 따라서 신발을 구매한 고객들의 평점이 옷을 구매한 고객들의 평점보다 높다고 할 수 있다.


```python
import numpy as np

footwear = len(data.loc[data.Category == 'Footwear', 'Review Rating'])
clothing = len(data.loc[data.Category == 'Clothing', 'Review Rating'])

mean = data.loc[data.Category == 'Footwear', 'Review Rating'].mean() - data.loc[data.Category == 'Clothing', 'Review Rating'].mean()

stat_footwear = (np.std(data.loc[data.Category == 'Footwear', 'Review Rating'], ddof = 1))**2
stat_clothing = (np.std(data.loc[data.Category == 'Clothing', 'Review Rating'], ddof = 1))**2

df = (stat_footwear/footwear+stat_clothing/clothing)**2/((stat_footwear/footwear)**2/(footwear-1)+(stat_clothing/clothing)**2/(clothing - 1))

lower =  mean - stats.t.ppf(0.975, df=df)*np.sqrt((stat_footwear / footwear + stat_clothing / clothing))
upper = mean + stats.t.ppf(0.975, df=df)*np.sqrt((stat_footwear / footwear + stat_clothing / clothing))
print('95% 신뢰구간: (', lower, ', ', upper, ')')
```

    95% 신뢰구간: ( 0.0006301543767564116 ,  0.13438531469806803 )
    

### (d) 평점을 0.5단위 구간으로 나누고 (0-0.5, 0.5-1.0, 1.0 - 1.5, ..., 4.5-5.0), 계절에 따라 막대그래프를 이용해서 평점의 빈도를 확인하여라. 또한 분할표를 만들고 평점과 계절이 독립이라는 가설을 유의수준 5\%에서 검정하여라.


```python
data['Group'] = pd.cut(data['Review Rating'], bins=[0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0])

cross = pd.crosstab(data['Group'], data['Season'])

cross.plot.bar(stacked=True)
```




    <Axes: xlabel='Group'>




    
![png](output_17_1.png)
    



```python
stats.chi2_contingency(cross)
```




    Chi2ContingencyResult(statistic=13.073831917273306, pvalue=0.5965951293693335, dof=15, expected_freq=array([[ 16.5       ,  16.90615385,  16.16153846,  16.43230769],
           [195.25      , 200.05615385, 191.24487179, 194.44897436],
           [199.75      , 204.66692308, 195.6525641 , 198.93051282],
           [197.75      , 202.61769231, 193.69358974, 196.93871795],
           [190.75      , 195.44538462, 186.83717949, 189.9674359 ],
           [175.        , 179.30769231, 171.41025641, 174.28205128]]))



H0: 평점과 계절은 서로 독립이다.
H1: 평점과 계절은 서로 독립이 아니다.
p-value가 0.5965951293693335로 유의수준 0.05보다 크므로 귀무가설을 기각하지 못한다. 따라서 평점과 계절은 서로 독립이라고 할 수 있다.

### (e) 할인(Discount Applied)을 받으면 평점을 후하게 준다는 것이 사실인지 확인하고자 한다. 평점을 4.0을 기준으로 구분하고, 할인을 받은 그룹과 받지 않은 그룹 사이에 평점 4.0이상 비율에 차이가 있는지 유의수준 5\%에서 검정하여라.


```python
from statsmodels.stats.proportion import proportions_ztest

dis_yes = np.sum((data['Discount Applied'] == 'Yes') & (data['Review Rating'] >= 4))
dis_no = np.sum((data['Discount Applied'] == 'No') & (data['Review Rating'] >= 4))

yes = np.sum(data['Discount Applied'] == 'Yes')
no = np.sum(data['Discount Applied'] == 'No')

proportions_ztest([dis_yes, dis_no], [yes, no])
```




    (-0.322259179045885, 0.747256355264996)



H0: 할인을 받은 그룹과 받지 않은 그룹 사이에 평점 4.0이상 비율에 차이가 없음
H1: 할인을 받은 그룹과 받지 않은 그룹 사이에 평점 4.0이상 비율에 차이가 있음
p-value가 0.747256355264996로 유의수준 0.05보다 크므로 귀무가설을 기각하지 못한다. 따라서 할인을 받은 그룹과 받지 않은 그룹 사이에 평점 4.0이상 비율에 차이가 없다고 할 수 있다.
